<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Braid Debugger</title>
    <style>
      html,body {
        height: 100%;
        background: #242424;
        color: white;
      }

      img {
        max-width: 100%;
        max-height: 100%;
        margin: auto;
      }

      button * {
        pointer-events: none;
      }
    </style>
    <link href="/styles/system.css" rel="stylesheet">
    <script>
      const parameters = new URLSearchParams(window.location.search)
      const world = parameters.get('world')
      window.plan98 = {
        parameters,
        provider: 'braid.org',
        host: world ? world : window.location.host,
      }

      document.write(`<link href="/cdn/${window.plan98.host}/default.css" rel="stylesheet">`)
    </script>
    <script type="importmap">
      {
        "imports": {
          "@sillonious/module": "/module.js",
          "diffhtml": "https://esm.sh/diffhtml@1.0.0-beta.30",
          "eruda": "https://esm.sh/eruda@3.0.1"
        }
      }
    </script>
  </head>
  <body>
    <braid-debugger></braid-debugger>
    <script type="module">
      import module from '@sillonious/module'
      import eruda from 'eruda'

      voltron('braid-debugger', module, eruda)

      function voltron(tag, module, eruda) {
        customElements.define(tag, class WebComponent extends HTMLElement {
          constructor() {
            super();
            this.$ = module(tag)
            this.$.draw(container => {
              eruda.init({ container });
              eruda.show()
              eruda.add({
              name: 'Braid',
                init($el) {
                  this._$el = $el;
                },
                show() {
                  this._$el.show()
                  this._$el.html('<iframe title="braid-debugger" src="https://braid.org?world=braid.org" style="width: 100%; height: 100%; border: none;"></iframe>');
                },
                hide() {
                  this._$el.hide()
                  this._$el.html('');
                },
                destroy() {}
              })
            })

          }
        });
      }
    </script>
  </body>
</html>
